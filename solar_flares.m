

% Monthly counts of grouped solar flares
% from Jan 1965 to Mar 2009

years = [1965: 1: 2008];
solar_flares_in_year = [1899, 4859, 9709, 8022, 7153, 8632, 6031, 5203, 3180, 2594, 1165, 614, 1724, 5514, 10012, 10132, 9218, 7932, 4048, 2901, 975, 730, 1627, 4816, 7711, 6610, 6495, 3952, 2541, 1066, 639, 280, 790, 2423, 3936, 4474, 3597, 3223, 1552, 728, 571, 159, 261, 24];

months_offset = [1: 1: (2002-1965+1)*12];
solar_flares_in_month = [158, 85, 110, 74, 315, 231, 99, 127, 173, 184, 150, 193,    194, 205, 390, 449, 429, 323, 528, 391, 558, 432, 417, 543,    796, 589, 1009, 694, 771, 629, 907, 911, 573, 946, 775, 1109,    1037, 773, 519, 460, 768, 697, 573, 611, 616, 772, 556, 640,    581, 504, 669, 655, 839, 694, 489, 551, 540, 643, 566, 422,    466, 646, 578, 688, 722, 836, 954, 780, 811, 797, 687, 667,    598, 505, 387, 546, 461, 430, 713, 673, 518, 375, 431, 394,    384, 599, 621, 361, 614, 541, 404, 515, 371, 408, 175, 210,    221, 171, 410, 453, 388, 270, 232, 182, 353, 201, 136, 163,    127, 148, 79, 364, 255, 204, 360, 187, 270, 366, 153, 81,    68, 82, 69, 19, 42, 85, 196, 346, 68, 38, 127, 25,    69, 18, 180, 60, 38, 48, 6, 47, 57, 23, 13, 55,    54, 77, 18, 76, 64, 210, 140, 140, 250, 252, 107, 336,    274, 588, 338, 526, 330, 460, 533, 346, 554, 499, 418, 648,    926, 781, 731, 731, 907, 772, 750, 821, 901, 1018, 888, 786,    703, 689, 624, 1092, 811, 956, 763, 720, 924, 988, 1027, 838,    578, 782, 914, 915, 658, 592, 893, 982, 680, 836, 773, 615,    631, 766, 803, 490, 553, 769, 696, 753, 615, 544, 564, 748,     332, 220, 337, 346, 609, 561, 427, 389, 289, 298, 88, 152,    353, 461, 366, 440, 492, 185, 151, 161, 95, 36, 92, 69,    104, 29, 38, 119, 129, 116, 185, 53, 25, 108, 19, 50,     51, 158, 54, 56, 68, 3, 71, 12, 14, 174, 56, 13,    36, 7, 52, 192, 205, 61, 132, 185, 172, 198, 273, 114,    217, 109, 413, 328, 274, 551, 502, 375, 513, 429, 518, 587,    695, 544, 672, 488, 691, 977, 474, 699, 733, 547, 665, 526,    550, 424, 684, 442, 580, 445, 454, 703, 449, 574, 623, 682,    672, 503, 625, 570, 458, 574, 582, 581, 425, 565, 396, 544,     380, 462, 287, 412, 214, 271, 413, 447, 287, 325, 248, 206,    123, 392, 357, 262, 237, 296, 154, 92, 82, 167, 104, 275,     217, 67, 111, 60, 40, 56, 81, 101, 72, 117, 45, 99,    82, 95, 77, 42, 69, 66, 29, 37, 23, 99, 14, 6,    14, 3, 5, 34, 21, 16, 54, 31, 3, 0, 44, 45,    8, 22, 18, 43, 59, 18, 26, 75, 188, 31, 228, 74,     78, 76, 216, 161, 264, 177, 164, 248, 249, 155, 268, 367,    330, 212, 271, 145, 330, 466, 544, 368, 192, 264, 598, 243,    175, 248, 462, 362, 473, 505, 818, 364, 372, 208, 241, 246,    147, 77, 383, 284, 164, 282, 137, 376, 549, 325, 405, 468,    318, 261, 155, 263, 259, 91, 318, 474, 280, 329, 279, 196
    ];

figure(1);
scatter(years, solar_flares_in_year);
title('Solar Flare Index across 1965-2008 in years');
xlabel('year');
ylabel('Solar Flare Indexes');

figure(2);
Y = fft(solar_flares_in_year);

Fs = 1;
L = 2008 - 1965 + 1;
P2 = abs(Y/L);
P1 = P2(1:L/2+1);
P1(2:end-1) = 2*P1(2:end-1);
f = Fs*(0:(L/2))/L;
plot(f,P1) 
title('Single-sided Solar Flare Index Spectrum of 1965-2008 in years')
xlabel('f (1/year)')
ylabel('|P(f)|')


figure(3)
scatter(months_offset, solar_flares_in_month);
title('Solar Flare Index across 1965-2002 in months');
xlabel('month offset');
ylabel('Solar Flare Indexes');

figure(4)
Y = fft(solar_flares_in_month);

Fs = 1;
L = length(solar_flares_in_month);
P2 = abs(Y/L);
P1 = P2(1:L/2+1);
P1(2:end-1) = 2*P1(2:end-1);
f = Fs*(0:(L/2))/L;
plot(f,P1) 
title('Solar Flare Index Spectrum of 1965-2002 for every months')
xlabel('f (1/month)')
ylabel('|P(f)|')